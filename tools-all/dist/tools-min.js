!function(t,e){$.canvasProgress__=function(i){var o=function(t,e,o){var s=this;this.c=t,this.ctx=t.getContext("2d"),this.cw=e,this.ch=o,this.o=i,this.loaded=0,this.loaderSpeed=i.speed||.6,this.loaderHeight=i.barHeight||10,this.loaderWidth=i.barWidth||310,this.loader={x:this.cw/2-this.loaderWidth/2,y:this.ch/2-this.loaderHeight/2},this.particles=[],this.particleLift=180,this.hueStart=0,this.hueEnd=120,this.hue=0,this.gravity=.15,this.particleRate=5,this.Particle=function(){this.x=s.loader.x+s.loaded/100*s.loaderWidth-s.rand(0,1),this.y=s.ch/2+s.rand(0,s.loaderHeight)-s.loaderHeight/2,this.vx=(s.rand(0,4)-2)/100,this.vy=(s.rand(0,s.particleLift)-2*s.particleLift)/100,this.width=s.rand(1,4)/2,this.height=s.rand(1,4)/2,this.hue=s.hue},this.Particle.prototype.update=function(t){this.vx+=(s.rand(0,6)-3)/100,this.vy+=s.gravity,this.x+=this.vx,this.y+=this.vy,this.y>s.ch&&s.particles.splice(t,1)},this.Particle.prototype.render=function(){s.ctx.fillStyle=i.particlesColor||"hsla("+this.hue+", 100%, "+s.rand(50,70)+"%, "+s.rand(20,100)/100+")",s.ctx.fillRect(this.x,this.y,this.width,this.height)}};o.prototype={constructor:o,init:function(){this.loop()},updateLoader:function(){this.loaded<100?this.loaded+=this.loaderSpeed:this.loaded=0},renderLoader:function(){this.ctx.fillStyle="#000",this.ctx.fillRect(this.loader.x,this.loader.y,this.loaderWidth,this.loaderHeight),this.ctx.fillStyle=this.o.color||"#fff",this.ctx.font=(this.o.fontSize||24)+"px serif",this.ctx.shadowColor=this.o.shadowColor||"rgba(220,220,220,.6)",this.ctx.shadowOffsetX=this.o.shadowOffsetX||2,this.ctx.shadowOffsetY=this.o.shadowOffsetY||2,this.ctx.shadowBlur=this.o.shadowBlur||8,this.ctx.textAlign="center",this.ctx.fillText(this.o.text||"正在处理中，请稍等！",this.loader.x+this.loaderWidth/2,this.loader.y-(this.o.textOffset||5)),this.ctx.shadowColor=null,this.ctx.shadowOffsetX=null,this.ctx.shadowOffsetY=null,this.ctx.shadowBlur=null,this.hue=this.hueStart+this.loaded/100*(this.hueEnd-this.hueStart);var t=this.loaded/100*this.loaderWidth;this.ctx.fillStyle=this.o.barColor||"hsla("+this.hue+", 100%, 40%, 1)",this.ctx.fillRect(this.loader.x,this.loader.y,t,this.loaderHeight),this.ctx.fillStyle="#222",this.ctx.fillRect(this.loader.x,this.loader.y-1,t,this.loaderHeight/2)},rand:function(t,e){return~~(Math.random()*(e-t+1)+t)},hitTest:function(t,e,i,o,s,a,n,r){return!(t+i<s||s+n<t||e+o<a||a+r<e)},createParticles:function(){for(var t=this.particleRate;t--;)this.particles.push(new this.Particle)},updateParticles:function(){for(var t=this.particles.length;t--;){this.particles[t].update(t)}},renderParticles:function(){for(var t=this.particles.length;t--;){this.particles[t].render()}},clearCanvas:function(){this.ctx.globalCompositeOperation="source-over",this.ctx.clearRect(0,0,this.cw,this.ch),this.ctx.globalCompositeOperation="lighter"},loop:function(){var t=this.c.id,i=this,o=function(){e.getElementById(t)&&requestAnimationFrame(o,i.c),i.clearCanvas(),i.createParticles(),i.updateLoader(),i.updateParticles(),i.renderLoader(),i.renderParticles()};o()}};if(function(){var t=e.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}){var s=e.createElement("canvas");s.className="canvas",s.addEventListener("click",function(e){e.stopPropagation(),(t.event||e).cancelBubble=!0}),s.id=i.canvasId||"canvas-progress-"+parseInt(100*Math.random()),s.width=i.canvasWidth||400,s.height=i.canvasHeight||100;var a=s.width,n=s.height;i.target?i.target.append(s).data("progress",s):e.body.appendChild(s);var r=new o(s,a,n);return function(){if("function"!=typeof t.requestAnimationFrame){for(var e=0,i=["ms","moz","webkit","o"],o=0;o<i.length&&!t.requestAnimationFrame;++o)t.requestAnimationFrame=t[i[o]+"RequestAnimationFrame"],t.cancelAnimationFrame=t[i[o]+"CancelAnimationFrame"]||t[i[o]+"CancelRequestAnimationFrame"];t.requestAnimationFrame||(t.requestAnimationFrame=function(i,o){var s=(new Date).getTime(),a=Math.max(0,16-(s-e)),n=t.setTimeout(function(){i(s+a)},a);return e=s+a,n}),t.cancelAnimationFrame||(t.cancelAnimationFrame=function(t){clearTimeout(t)})}}(),r.init(),s}}}(window,document),function(t,e,i,o){"use strict";var s=function(t,e){this.$el=t,this.o=e};s.prototype={constructor:s,initTip:function(){var t=this.o;this.$tooltipOuter=o(['<div class="tooltip-outer">','<div class="tooltip-content"></div>',"</div>"].join("")),t.id&&this.$tooltipOuter.attr("id",t.id),this.$tooltipOuter.addClass(t.placement||"bottom"),this.$tooltipContent=this.$tooltipOuter.children(".tooltip-content"),t.border&&this.$tooltipContent.css("border","1px solid #333"),this.$tooltipContent.html(o.isFunction(t.html)?t.html():t.text||this.$el.html()),this.$el.on({"mouseenter.tip":o.proxy(function(){this.$tooltipOuter.addClass("show")},this),"mouseleave.tip":o.proxy(function(){this.$tooltipOuter.removeClass("show")},this)}).append(this.$tooltipOuter).data("tip",this)},initAlert:function(){var t=this.o;this.$alert=o(['<div class="alert-box">','<div class="layer"></div>','<div class="alert-content">','<div class="alert-title">',"<h1>提示</h1>",'<i class="glyphicon glyphicon-remove"></i>',"</div>",'<div class="alert-body"></div>','<div class="alert-bar">','<button class="btn btn-primary confirm">确定</button> ','<button class="btn btn-default cancel">取消</button>',"</div>","</div>","</div>"].join("")).data("alert",this),this.$alert.on({click:o.proxy(function(t){this.stopPropagation(t),this.hideAlert()},this),mousewheel:this.stopPropagation}).on("click.alert",".alert-content",o.proxy(this.stopPropagation,this)).on("click.alert",".alert-title>i",o.proxy(this.hideAlert,this)).on("click.alert",".alert-bar>.btn",o.proxy(this.hideAlert,this)),t.title&&this.$alert.find(".alert-title").children("h1").text(t.title),o.isFunction(t.html)&&this.$alert.find(".alert-body").append(t.html()),o.isFunction(t.onconfirm)&&this.$alert.on("click.alert",".confirm",t.onconfirm),o.isFunction(t.oncancel)&&this.$alert.on("click.alert",".cancel",t.oncancel),("ALERT"==this.$el[0].nodeName?this.$el.after(this.$alert).parent():this.$el.append(this.$alert)).on("click",o.proxy(this.showAlert,this))},hideAlert:function(){this.$alert.removeClass("show-up"),o(i.body).css({overflow:"initial",paddingRight:""})},showAlert:function(){this.$alert.addClass("show-up"),o(i.body).css({overflow:"hidden",paddingRight:t.innerWidth-i.body.clientWidth+"px"})},stopPropagation:function(e){e.stopPropagation(),(t.event||e.originalEvent).cancelBubble=!0},initSwitch:function(){var t=this.o,e=this.$el;this.ontext=t.ontext||"启用",this.offtext=t.offtext||"停用";var i,s,a=this.$switch=o(['<div class="switch-container"><div class="switch-box">','<div class="switcher">',(i="<span>%s</span>",s=this.offtext,i.replace("%s",s)),"</div>","</div></div>"].join("")).on("click.switch",".switch-box:not([data-disabled])",o.proxy(this.switchToggle,this)),n=this.$switchBox=this.$switch.children(".switch-box").data("switch",this);t.square&&n.addClass("square").children(".switcher").addClass("square"),t.on&&n.addClass("on").data("on",!0).find("span").html(this.ontext),t.disabled&&n.addClass("disabled"),"SWITCH"==e[0].tagName?e.after(a):e.append(a)},switchToggle:function(){var t=this.$switchBox;if(!t.hasClass("disabled")){var e=this.o;t.data("on")?t.removeClass("on").data("on",!1).find("span").html(this.offtext)&&o.isFunction(e.onoff)&&e.onoff(t.data("on")):t.addClass("on").data("on",!0).find("span").html(this.ontext)&&o.isFunction(e.onon)&&e.onon(t.data("on"))}},initLoader:function(){var t=this.o,s="LOADER"==this.$el[0].nodeName?this.$el.parent():this.$el,a=o(t.target||i.body);s.on("click.loader",function(){if(!a.children("canvas").length){var s=o.canvasProgress__({target:a,canvasWidth:a.outerWidth(),canvasHeight:a.outerHeight(),text:t.text,textOffset:t.textOffset,color:t.color,fontSize:t.fontSize,barColor:t.barColor,barWidth:.6*a.outerWidth(),barHeight:.02*a.outerHeight(),particlesColor:t.particlesColor,speed:t.speed,shadowColor:t.shadowColor,shadowOffsetX:t.shadowOffsetX,shadowOffsetY:t.shadowOffsetY,shadowBlur:t.shadowBlur});e.defineProperty(a[0],"loaded",{enumerable:!0,configurable:!0,set:function(e){if(e){s.remove?s.remove():s.parentNode.removeChild(s);var o=i.createElement("canvas"),n=o.getContext("2d");o.className="canvas",o.width=a.outerWidth(),o.height=a.outerHeight(),n.fillStyle=t.color||"#fff",n.font=(t.fontSize||36)+"px serif",n.textAlign="center",n.fillText(t.loadedText||"加载完成！",o.width/2,o.height/2+5),a.append(o),setTimeout(function(){o.remove?o.remove():o.parentNode.removeChild(o)},1500)}}})}}).data("loader",this)},requiredInput:function(){var t,e=(this.o.type||"").trim(),i=this,o="不能为空！";switch(e){case"number":t=/^\d+$/,o="请输入数字！",this.typeCode=1;case"money":t=/^-?\d*\.?\d*$|^-?\d+$/,o="请输入整数或小数！",this.typeCode=2}/\//.test(e[0])&&(t=new RegExp(e.substr(1,e.length-2))),this.o.errortext&&(o=this.o.errortext),this.$el.on({"input.required":function(){(t?t.test(this.value):""!=this.value.trim())||(this.value="")},"blur.required":function(){i.blurValidate(this.value)?i.$el.removeClass("invalid"):i.$el.addClass("invalid").val("").attr("placeholder",o)}})},blurValidate:function(t){return 2==this.typeCode?/^-?\d+\.?\d+$|^-?\d+$/.test(t):""!=t}},o.fn.tip=function(t){return new s(this,t).initTip(),this},o.fn.alert=function(t){return new s(this,t).initAlert(),this},o.fn.switch=function(t){return new s(this,t).initSwitch(),this},o.fn.loader=function(t){return new s(this,t).initLoader(),this},o.fn.requiredInput=function(t){return new s(this,t).requiredInput(),this},o(function(){var t=function(t){return o.tools__&&o.isPlainObject(o.tools__[t])};o("[data-tip]").each(function(e,i){var s=o(i),a=s.data();s.tip({border:a.border,placement:a.placement,id:a.id,text:a.text,html:t("tips")&&o.tools__.tips[a.html]})}),o("alert").each(function(e,i){var s=o(i),a=s.data();s.alert({title:a.title,html:t("alert")&&o.tools__.alert[a.html],onconfirm:t("alert")&&o.tools__.alert[a.onconfirm],oncancel:t("alert")&&o.tools__.alert[a.oncancel]}).remove()}),o("switch").each(function(e,i){var s=o(i),a=s.data();s.switch({disabled:a.disabled,on:a.on,ontext:a.ontext,offtext:a.offtext,onon:t("switch")&&o.tools__.switch[a.onon],onoff:t("switch")&&o.tools__.switch[a.onoff],square:a.square}).remove()}),o("loader").each(function(t,e){var i=o(e),s=i.data();i.loader({target:s.target,text:s.text,loadedText:s.loadedText,textOffset:s.textOffset,fontSize:s.fontSize,color:s.color,barColor:s.barColor,particlesColor:s.particlesColor,speed:s.speed,shadowColor:s.shadowColor,shadowOffsetX:s.shadowOffsetX,shadowOffsetY:s.shadowOffsetY,shadowBlur:s.shadowBlur}).remove()}),o("input[data-required]").each(function(t,e){var i=o(e),s=i.data();i.requiredInput({type:s.type,errortext:s.errortext})})})}(window,Object,document,jQuery);